<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="How I built this site...">
  <meta name="title" content="Portfolio - A gulp Project">
  <meta name="author" content="Akshay Anand">
  <meta property="og:site_name" content="CrayonBytes">
  <meta property="og:title" content="Portfolio - A gulp Project">
  <meta property="og:image" content="http://crayonbytes.us/images/projects/portfolio/portTile.png">
  <meta property="og:description" content="How I built this site...">
  <meta property="og:type" content="article">
  <meta property="article:author" content="Akshay Anand">
  <meta property="article:published_time" content="Fri Jul 10 2015 01:29:35 GMT-0400 (EDT)">
  <meta name="twitter:site" content="@CrayonBytes">
  <meta name="twitter:image:src" content="http://crayonbytes.us/images/projects/portfolio/portTile.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:creator" content="@CrayonBytes">
  
  <title>Portfolio - A gulp Project</title>

  <link href="https://fonts.googleapis.com/css?family=Droid+Sans|Open+Sans|Varela+Round" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="../../css/foundation-icons.css">
	<link rel="stylesheet" type="text/css" href="../../css/main.css">
</head>
<body class="blog">

    <a class="home-btn" href="/"><i class="fi-home"></i></a>
    <div class="mobile-toolbar">
      <a class="mobile-home-btn" href="/"><i class="fi-home"></i> Home</a>
    </div>
    <h1 class="blog-title">
        Portfolio - A gulp Project
    </h1>
    <div class="by-line">
      <span class="by-line__author">By <strong><a href="/">Akshay Anand</a></strong></span>
      <span class="by-line__date js-create-date">Fri Jul 10 2015 01:29:35 GMT-0400 (EDT)</span>
    </div>
    <div class="blog-content">
        
        <article>
            <p><div class="button-rack"><a href="http://crayonbytes.us" target="_blank" class="btn btn-primary"><i class="fi-monitor"></i> Portfolio Site</a><a href="https://github.com/xaksis/portfolio" target='_blank' class="btn btn-default"><i class="fi-social-github"></i> Github Link</a></a></div>

<p>#Overview
This is so meta! Describing this site as a project that is displayed on this site! A static site generated by gulp for my portfolio, blog and design bits. </p>
<h1 id="-i-class-fi-page-multiple-text-emphasis-i-stack"><i class="fi-page-multiple text-emphasis"></i> Stack</h1>
<ul>
<li><strong>Front-end</strong> - jQuery + sass + markdown + handlebars</li>
<li><strong>Backend</strong> - None</li>
<li><strong>Task runner</strong> - gulp</li>
</ul>
<h1 id="the-story">The Story</h1>
<p>I have wanted to create a simple portfolio site for a while now. I kept delaying it, partly due to procrastination and partly because I always had other projects that appeared to be higher priority, until a few weeks ago.</p>
<p>While working on <a href="./calorious.html">Calorious</a> I reached a point where I felt like I <strong>had</strong> to take a break from it. Anyone in my profession is well aware of this feeling. Even though you are excited about the project you need to take a step back and regroup. With this realization, I thought why not use this opportunity to do something I&#39;ve always wanted to do? Build my portfolio site!</p>
<h1 id="requirements">Requirements</h1>
<p>Thus, I sat down to create a preliminary list of requirements.</p>
<ul>
<li><strong>Simplicity</strong> - I wanted to keep the site simple, both visually and technically. I didn&#39;t want to use a heavy framework for front end. </li>
<li><strong>Versatile</strong> - I wanted to showcase all my work. This could include writings, projects, designs or even sketches but didn&#39;t want to have a complicated hierarchy of navigation. </li>
<li><strong>DRY</strong> - even though I knew that the site I had in mind did not warrant any sophisticated framework, I did want to have the ability of using templates so the site is maintainable. </li>
<li><strong>Adding content should be easy</strong> - I was envisioning adding content quite frequently once I had the site up and running so I needed something where the process would be as painless as possible.</li>
</ul>
<h1 id="gulp-to-the-rescue">Gulp to the rescue</h1>
<p>I knew from experience that most of my requirements can be fulfilled just by gulp. I could potentially use it to create a static site generator. What I wasn&#39;t sure about was weather I could wire something up for layouts in gulp without putting in a lot of effort. Because let&#39;s face it, if it is more than a few lines of code, why wouldn&#39;t I just use something like <a href="http://docpad.org">Docpad</a>?</p>
<p>##The thought process
Initial decisions were relatively easy.</p>
<ul>
<li><p>For creating content I would use markdown. I can write stuff fast in markdown and gulp can spit out HTML based on my styles.</p>
<pre><code class="lang-javascript">gulp.task(&#39;markup:base&#39;, function(){
  return gulp.src([paths.src.base+&#39;*.html&#39;])
      .pipe(gulp.dest(paths.target.base))
      .pipe(plugins.connect.reload());
});
</code></pre>
</li>
<li><p>for layout and templating I&#39;d use handlebars. This will help me reuse my code and follow dry principles.</p>
<pre><code class="lang-javascript">gulp.task(&#39;script&#39;, function(){
  return plugins.streamqueue({objectMode: true},
          //vendor files first
          gulp.src(paths.vendor.js),
          //project specific js files
          gulp.src([paths.src.base+paths.src.js])
          .pipe(plugins.jshint())
          .pipe(plugins.jshint.reporter(&#39;default&#39;)),
          //templates
          gulp.src([paths.src.base+paths.src.templates])
              .pipe(plugins.handlebars())
              .pipe(plugins.wrap(&#39;Handlebars.template(&lt;%= contents %&gt;)&#39;))
              .pipe(plugins.declare({
                namespace: &#39;pApp.templates&#39;,
                noRedeclare: true, // Avoid duplicate declarations 
              }))
              .pipe(plugins.concat(&#39;templates.js&#39;))
      )
      .pipe(plugins.sourcemaps.init())
          .pipe(plugins.concat(&#39;main.js&#39;))
          .pipe(plugins.uglify())
      .pipe(plugins.sourcemaps.write())
      .pipe(gulp.dest(paths.target.base+paths.target.js))
      .pipe(plugins.connect.reload());
});
</code></pre>
</li>
<li><p>my main problem now was how do I make my home page aware of the content? </p>
<ul>
<li><p>If I could somehow have gulp create a <strong>json</strong> dump of all my content&#39;s meta data, I could then read it from any page and display / link it correctly.</p>
</li>
<li><p>After some research I realized that I could do exactly that by dumping the frontmatter  of my markdown files. </p>
<pre><code class="lang-javascript">/*
* function to generate json
***********************************/
function dumpJson(directory){
    return gulp.src(paths.src.base+paths.src[directory], 
        {base: paths.src.base + &#39;markup&#39;})
        .pipe(plugins.frontMatter({property: &#39;meta&#39;}))
        .pipe(plugins.data(function(file){
            file.meta.path = file.relative;
            if(!file.meta.createDate)
                file.meta.createDate = file.stat.birthtime;
        }))
        .pipe(plugins.pluck(&#39;meta&#39;, directory+&#39;.json&#39;))
        .pipe(plugins.data(function(file){
            file.contents = new Buffer(JSON.stringify(file.meta))
        }))
        .pipe(gulp.dest(paths.target.base+&#39;content/&#39;));
}

gulp.task(&#39;contentJson&#39;, function(){
return dumpJson(&#39;allMd&#39;)
    .pipe(plugins.connect.reload());
});
</code></pre>
</li>
<li><p>I now had a rudimentary version of docpad like system, where in my markdown files, I could specify</p>
<ul>
<li><p>what layout to use</p>
</li>
<li><p>what tile image to use</p>
</li>
<li><p>what cover image to use </p>
</li>
<li><p>and pretty much whatever I wanted to surface up about the articles.</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>So there you have it. A fully functional simple static site generator where most of the heavy lifting is done by Gulp! To take a look at the full gulp file and the project, check out the <a href="https://github.com/xaksis/portfolio" target="_blank">Github repo</a></p>
</p>
        </article>
    </div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-64981751-1', 'auto');
  ga('send', 'pageview');

</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/3.0.3/handlebars.runtime.js"></script>
<script type="text/javascript" src="../../js/main.js"></script>
<script>
	hljs.initHighlightingOnLoad();
</script>
</body>
</html>
